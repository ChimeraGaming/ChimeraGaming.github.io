---
layout: null
permalink: /search.json
---

[
{%- comment -%}
  Build a robust set of all documents to index:
  - site.pages (normal pages)
  - site.posts  (blog posts if you add any)
  - all collection docs (excluding 'posts' which we've already included)
  We also skip anything with search:false or missing a title.
{%- endcomment -%}

{%- assign docs = site.pages | where_exp: "p", "p.search != false and p.title" -%}
{%- assign docs = docs | concat: site.posts -%}

{%- for c in site.collections -%}
  {%- unless c.label == "posts" -%}
    {%- assign docs = docs | concat: c.docs -%}
  {%- endunless -%}
{%- endfor -%}

{%- assign clean = "" | split: "" -%}
{%- for d in docs -%}
  {%- if d.search != false and d.title -%}
    {%- assign clean = clean | push: d -%}
  {%- endif -%}
{%- endfor -%}

{%- for item in clean -%}
  {
    "title": {{ item.title | jsonify }},
    "url": {{ item.url | relative_url | jsonify }},
    "content": {{ item.content | strip_html | normalize_whitespace | jsonify }}
  }{% unless forloop.last %},{% endunless %}
{%- endfor -%}
]
